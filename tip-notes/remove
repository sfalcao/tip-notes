#!/bin/bash
#==============================================================================
#
#   DESCRIPTION:  remove tip-notes
#
#         USAGE:  ./remove
# 
#        AUTHOR:  S. Falcao
#       CREATED:  11.07.2020 16:09 BRST
#
#==============================================================================

__script_name__="remove"

# get:
# __project_name__, __project_binaries_folder__, __project_links_folder__
#
# from project-header file
source ./project-header.sh


# if parameters are passed shows help
if [[ "${#}" -gt 0 ]] && [[ "${1}" != "--purge" ]]; then
    echo
    echo "usage:"
    echo
    echo "  sudo ${__script_name__} [--purge]"
    echo
    exit 1
fi


# aborts if already installed by apt
if apt list --installed 2> /dev/null | grep 'tip-notes'; then
    echo
    echo "ATTENTION!"
    echo
    echo\
        "${___HEADER___PROJECT_NAME___} has been installed using apt system's"\
        "package manager!"
    echo
    echo "Remove installed version using:"
    echo "sudo apt remove tip-notes"
    echo
    exit 1
fi

# remove files and folders destination
rm -r "${___HEADER___PROJECT_EXECUTABLES_FOLDER___}"

# remove autocompletion file
# TODO: expand to remove also fish autocompletion
rm "${___HEADER___PROJECT_AUTOCOMPLETION_FILE___}"

# remove links
rm "${___HEADER___PROJECT_LINKS_FOLDER___}/tip"

# remove docs
rm -r "${___HEADER___PROJECT_DOC_FOLDER___}"

# remove man page
rm -r /usr/local/man/man1/tip.1.gz

# purge files if required
if [[ "${1}" == "--purge" ]]; then
    rm -r "${___HEADER___PROJECT_CONFIG_FOLDER___}"
fi

exit 0
